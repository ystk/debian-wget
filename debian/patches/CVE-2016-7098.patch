Index: wget-1.16/src/http.c
===================================================================
--- wget-1.16.orig/src/http.c	2020-01-15 15:53:34.948972185 +0100
+++ wget-1.16/src/http.c	2020-01-15 15:58:28.731684101 +0100
@@ -39,6 +39,7 @@
 #include <errno.h>
 #include <time.h>
 #include <locale.h>
+#include <fcntl.h>
 
 #include "hash.h"
 #include "http.h"
@@ -1481,6 +1482,7 @@
   wgint orig_file_size;         /* size of file to compare for time-stamping */
   time_t orig_file_tstamp;      /* time-stamp of file to compare for
                                  * time-stamping */
+  bool temporary;               /* downloading a temporary file */
 };
 
 static void
@@ -2490,6 +2492,15 @@
       xfree_null (local_file);
     }
 
+  hs->temporary = opt.delete_after || opt.spider || !acceptable (hs->local_file);
+  if (hs->temporary)
+    {
+      char *tmp = NULL;
+      asprintf (&tmp, "%s.tmp", hs->local_file);
+      xfree_null (hs->local_file);
+      hs->local_file = tmp;
+    }
+
   /* TODO: perform this check only once. */
   if (!hs->existence_checked && file_exists_p (hs->local_file))
     {
@@ -2935,7 +2946,15 @@
           open_id = 22;
           fp = fopen (hs->local_file, "wb", FOPEN_OPT_ARGS);
 #else /* def __VMS */
-          fp = fopen (hs->local_file, "wb");
+          if (hs->temporary)
+            {
+              fp = fdopen (open (hs->local_file, O_BINARY | O_CREAT | O_TRUNC | O_WRONLY, S_IRUSR | S_IWUSR), "wb");
+            }
+          else
+            {
+              fp = fopen (hs->local_file, "wb");
+            }
+
 #endif /* def __VMS [else] */
         }
       else
